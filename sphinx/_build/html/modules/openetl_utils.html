

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>openetl_utils package &mdash; OpenETL 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            OpenETL
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Utils</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="connector_utils.html">connector_utils module</a></li>
<li class="toctree-l1"><a class="reference internal" href="local_connection_utils.html">local_connection_utils module</a></li>
<li class="toctree-l1"><a class="reference internal" href="main_db_class.html">main_db_class module</a></li>
<li class="toctree-l1"><a class="reference internal" href="scheduler_utils.html">scheduler_utils module</a></li>
<li class="toctree-l1"><a class="reference internal" href="cache.html">cache module</a></li>
<li class="toctree-l1"><a class="reference internal" href="database_utils.html">database_utils module</a></li>
<li class="toctree-l1"><a class="reference internal" href="spark_utils.html">spark_utils module</a></li>
<li class="toctree-l1"><a class="reference internal" href="celery_utils.html">celery_utils module</a></li>
<li class="toctree-l1"><a class="reference internal" href="enums.html">enums module</a></li>
<li class="toctree-l1"><a class="reference internal" href="main_api_class.html">main_api_class module</a></li>
<li class="toctree-l1"><a class="reference internal" href="pipeline_utils.html">pipeline_utils module</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tables</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tables/app.html">app module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tables/scheduler.html">scheduler module</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OpenETL</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">openetl_utils package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/modules/openetl_utils.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="openetl-utils-package">
<h1>openetl_utils package<a class="headerlink" href="#openetl-utils-package" title="Link to this heading"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="openetl_utils.deprecated.html">openetl_utils.deprecated package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="openetl_utils.deprecated.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="openetl_utils.deprecated.html#module-openetl_utils.deprecated.api_utils">openetl_utils.deprecated.api_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.api_utils.check_basic_auth"><code class="docutils literal notranslate"><span class="pre">check_basic_auth()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.api_utils.create_df"><code class="docutils literal notranslate"><span class="pre">create_df()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.api_utils.flatten_data"><code class="docutils literal notranslate"><span class="pre">flatten_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.api_utils.flatten_dict_to_rows"><code class="docutils literal notranslate"><span class="pre">flatten_dict_to_rows()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.api_utils.get_data"><code class="docutils literal notranslate"><span class="pre">get_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.api_utils.get_data_from_api"><code class="docutils literal notranslate"><span class="pre">get_data_from_api()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.api_utils.get_pagination_parameters"><code class="docutils literal notranslate"><span class="pre">get_pagination_parameters()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.api_utils.parse_json"><code class="docutils literal notranslate"><span class="pre">parse_json()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.api_utils.parse_xml"><code class="docutils literal notranslate"><span class="pre">parse_xml()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.api_utils.read_api_tables"><code class="docutils literal notranslate"><span class="pre">read_api_tables()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.api_utils.read_api_tables_url"><code class="docutils literal notranslate"><span class="pre">read_api_tables_url()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.api_utils.read_connection_table"><code class="docutils literal notranslate"><span class="pre">read_connection_table()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.api_utils.return_final_df"><code class="docutils literal notranslate"><span class="pre">return_final_df()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.api_utils.send_request"><code class="docutils literal notranslate"><span class="pre">send_request()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="openetl_utils.deprecated.html#module-openetl_utils.deprecated.form_utils">openetl_utils.deprecated.form_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.form_utils.GenerateForm"><code class="docutils literal notranslate"><span class="pre">GenerateForm</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.form_utils.GenerateForm.connection_form"><code class="docutils literal notranslate"><span class="pre">GenerateForm.connection_form()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.form_utils.GenerateForm.create_connection"><code class="docutils literal notranslate"><span class="pre">GenerateForm.create_connection()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.form_utils.create_button_columns"><code class="docutils literal notranslate"><span class="pre">create_button_columns()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.form_utils.on_button_click"><code class="docutils literal notranslate"><span class="pre">on_button_click()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="openetl_utils.deprecated.html#module-openetl_utils.deprecated.generic_utils">openetl_utils.deprecated.generic_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.generic_utils.check_missing_values"><code class="docutils literal notranslate"><span class="pre">check_missing_values()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.generic_utils.execute"><code class="docutils literal notranslate"><span class="pre">execute()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.generic_utils.extract_connections_db_or_api"><code class="docutils literal notranslate"><span class="pre">extract_connections_db_or_api()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.generic_utils.fetch_metadata"><code class="docutils literal notranslate"><span class="pre">fetch_metadata()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.generic_utils.set_page_config"><code class="docutils literal notranslate"><span class="pre">set_page_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="openetl_utils.deprecated.html#module-openetl_utils.deprecated.jdbc_engine_utils">openetl_utils.deprecated.jdbc_engine_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.jdbc_engine_utils.JDBCEngine"><code class="docutils literal notranslate"><span class="pre">JDBCEngine</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.jdbc_engine_utils.JDBCEngine.conn"><code class="docutils literal notranslate"><span class="pre">JDBCEngine.conn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.jdbc_engine_utils.JDBCEngine.download_jar_from_maven"><code class="docutils literal notranslate"><span class="pre">JDBCEngine.download_jar_from_maven()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.jdbc_engine_utils.JDBCEngine.execute_query"><code class="docutils literal notranslate"><span class="pre">JDBCEngine.execute_query()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.jdbc_engine_utils.JDBCEngine.fetch_driver_classpath"><code class="docutils literal notranslate"><span class="pre">JDBCEngine.fetch_driver_classpath()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.jdbc_engine_utils.JDBCEngine.get_metadata"><code class="docutils literal notranslate"><span class="pre">JDBCEngine.get_metadata()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="openetl_utils.deprecated.html#openetl_utils.deprecated.jdbc_engine_utils.JDBCEngine.test"><code class="docutils literal notranslate"><span class="pre">JDBCEngine.test()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="openetl_utils.deprecated.html#module-openetl_utils.deprecated">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-openetl_utils.cache">
<span id="openetl-utils-cache-module"></span><h2>openetl_utils.cache module<a class="headerlink" href="#module-openetl_utils.cache" title="Link to this heading"></a></h2>
<p>This module contains various database connection parameters and database engines.</p>
</section>
<section id="module-openetl_utils.celery_utils">
<span id="openetl-utils-celery-utils-module"></span><h2>openetl_utils.celery_utils module<a class="headerlink" href="#module-openetl_utils.celery_utils" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.celery_utils.configure_task_logger">
<span class="sig-name descname"><span class="pre">configure_task_logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.celery_utils.configure_task_logger" title="Link to this definition"></a></dt>
<dd><p>Dynamically configure logging for each task based on job_id.
This appends Celery worker logs to the job-specific log file and includes console logs.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.celery_utils.get_task_details">
<span class="sig-name descname"><span class="pre">get_task_details</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.celery_utils.get_task_details" title="Link to this definition"></a></dt>
<dd><p>Fetches task details for the specified task ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>task_id</strong> (<em>str</em>) – Unique identifier for the task.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Task details.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>celery.result.AsyncResult</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.celery_utils.retry">
<span class="sig-name descname"><span class="pre">retry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tries</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delay</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.celery_utils.retry" title="Link to this definition"></a></dt>
<dd><p>Decorator to retry a task if it fails.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tries</strong> (<em>int</em>) – Number of times to retry a task.</p></li>
<li><p><strong>delay</strong> (<em>float</em>) – Time to wait between retries in seconds.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Decorated function with retry logic.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>callable</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.celery_utils.run_pipeline">
<span class="sig-name descname"><span class="pre">run_pipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_schema</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_schema</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spark_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hadoop_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.celery_utils.run_pipeline" title="Link to this definition"></a></dt>
<dd><p>Runs a pipeline with the specified configurations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>job_id</strong> (<em>str</em>) – Unique identifier for the job.</p></li>
<li><p><strong>job_name</strong> (<em>str</em>) – Name of the job.</p></li>
<li><p><strong>job_type</strong> (<em>str</em>) – Type of the job.</p></li>
<li><p><strong>source_connection</strong> (<em>dict</em>) – Connection details for the source database.</p></li>
<li><p><strong>target_connection</strong> (<em>dict</em>) – Connection details for the target database.</p></li>
<li><p><strong>source_table</strong> (<em>str</em>) – Source table name.</p></li>
<li><p><strong>target_table</strong> (<em>str</em>) – Target table name.</p></li>
<li><p><strong>source_schema</strong> (<em>str</em>) – Source schema name.</p></li>
<li><p><strong>target_schema</strong> (<em>str</em>) – Target schema name.</p></li>
<li><p><strong>spark_config</strong> (<em>dict</em>) – Spark configuration.</p></li>
<li><p><strong>hadoop_config</strong> (<em>dict</em>) – Hadoop configuration.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size for processing.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Additional keyword arguments.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Exception</strong> – If there is an error running the pipeline.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-openetl_utils.connector_utils">
<span id="openetl-utils-connector-utils-module"></span><h2>openetl_utils.connector_utils module<a class="headerlink" href="#module-openetl_utils.connector_utils" title="Link to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.connector_utils.connector_test_connection">
<span class="sig-name descname"><span class="pre">connector_test_connection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connector_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connector_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">ConnectionType.DATABASE</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auth_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">AuthType.BASIC</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">auth_params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.connector_utils.connector_test_connection" title="Link to this definition"></a></dt>
<dd><p>Tests the connection to the specified connector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>connector_name</strong> (<em>str</em>) – The name of the connector.</p></li>
<li><p><strong>connector_type</strong> (<a class="reference internal" href="enums.html#enums.ConnectionType" title="enums.ConnectionType"><em>ConnectionType</em></a>) – The type of connector, defaults to ConnectionType.DATABASE.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the connection is successful, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.connector_utils.fetch_data_from_connector">
<span class="sig-name descname"><span class="pre">fetch_data_from_connector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connector_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auth_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auth_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'public'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">page_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.connector_utils.fetch_data_from_connector" title="Link to this definition"></a></dt>
<dd><p>Fetches data from a connector based on the provided connection details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>connection_name</strong> (<em>str</em>) – The name of the connection.</p></li>
<li><p><strong>connection_type</strong> (<em>str</em>) – The type of the connection.</p></li>
<li><p><strong>table</strong> (<em>str</em>) – The name of the table to fetch data from.</p></li>
<li><p><strong>schema</strong> (<em>str</em><em>, </em><em>optional</em>) – The schema of the table. Defaults to “public”.</p></li>
<li><p><strong>page_limit</strong> (<em>int</em><em>, </em><em>optional</em>) – The maximum number of pages to fetch. Defaults to 10000.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.connector_utils.fetch_metadata">
<span class="sig-name descname"><span class="pre">fetch_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auth_options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection_type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.connector_utils.fetch_metadata" title="Link to this definition"></a></dt>
<dd><p>Fetch metadata from the given connection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>connections</strong> (<em>string</em>) – name of the connection</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>{“tables”: [],”schema”:[]}</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.connector_utils.get_connector_auth_details">
<span class="sig-name descname"><span class="pre">get_connector_auth_details</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connector_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connector_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">ConnectionType.DATABASE</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.connector_utils.get_connector_auth_details" title="Link to this definition"></a></dt>
<dd><p>Returns the authentication details for the specified connector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>connector_name</strong> (<em>str</em>) – The name of the connector.</p></li>
<li><p><strong>connector_type</strong> (<a class="reference internal" href="enums.html#enums.ConnectionType" title="enums.ConnectionType"><em>ConnectionType</em></a>) – The type of connector, defaults to ConnectionType.DATABASE.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the authentication details for the specified connector.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.connector_utils.get_connector_engine">
<span class="sig-name descname"><span class="pre">get_connector_engine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connector_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connector_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">ConnectionType.DATABASE</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.connector_utils.get_connector_engine" title="Link to this definition"></a></dt>
<dd><p>Returns the engine for the specified connector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>connector_name</strong> (<em>str</em>) – The name of the connector.</p></li>
<li><p><strong>connector_type</strong> (<a class="reference internal" href="enums.html#enums.ConnectionType" title="enums.ConnectionType"><em>ConnectionType</em></a>) – The type of connector, defaults to ConnectionType.DATABASE.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The engine for the specified connector.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.connector_utils.get_connector_image">
<span class="sig-name descname"><span class="pre">get_connector_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connector_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection_type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.connector_utils.get_connector_image" title="Link to this definition"></a></dt>
<dd><p>Fetch metadata from the given connection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>connections</strong> (<em>string</em>) – name of the connection</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>{“tables”: [],”schema”:[]}</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.connector_utils.get_connector_metadata">
<span class="sig-name descname"><span class="pre">get_connector_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connector_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connector_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'database'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.connector_utils.get_connector_metadata" title="Link to this definition"></a></dt>
<dd><p>Returns the metadata for the specified connector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>connector_name</strong> (<em>str</em>) – The name of the connector.</p></li>
<li><p><strong>connector_type</strong> (<a class="reference internal" href="enums.html#enums.ConnectionType" title="enums.ConnectionType"><em>ConnectionType</em></a>) – The type of connector, defaults to ConnectionType.DATABASE.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the metadata for the specified connector.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.connector_utils.get_created_connections">
<span class="sig-name descname"><span class="pre">get_created_connections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connector_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'database'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.connector_utils.get_created_connections" title="Link to this definition"></a></dt>
<dd><p>Returns a list of created connections for the specified connector type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>connection_name</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>)</p></li>
<li><p><strong>connector_type</strong> (<a class="reference internal" href="enums.html#enums.ConnectionType" title="enums.ConnectionType"><em>ConnectionType</em></a>) – The value of type of connector, defaults to ConnectionType.DATABASE.value</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of created connections.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.connector_utils.get_db_connector_engine">
<span class="sig-name descname"><span class="pre">get_db_connector_engine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connector_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.connector_utils.get_db_connector_engine" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.connector_utils.get_installed_connectors">
<span class="sig-name descname"><span class="pre">get_installed_connectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connector_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">ConnectionType.DATABASE</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.connector_utils.get_installed_connectors" title="Link to this definition"></a></dt>
<dd><p>Checks the available connectors based on the specified connector type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>connector_type</strong> (<a class="reference internal" href="enums.html#enums.ConnectionType" title="enums.ConnectionType"><em>ConnectionType</em></a>) – The type of connector to check, defaults to ConnectionType.DATABASE.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of available connectors based on the specified connector type.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.connector_utils.import_module">
<span class="sig-name descname"><span class="pre">import_module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Connector'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.connector_utils.import_module" title="Link to this definition"></a></dt>
<dd><p>Imports a module and initializes a class within it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>module_name</strong> (<em>str</em>) – The name of the module (without the .py extension).</p></li>
<li><p><strong>class_name</strong> (<em>str</em>) – The name of the class to initialize.</p></li>
<li><p><strong>*args</strong> – Positional arguments to pass to the class constructor.</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments to pass to the class constructor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>An instance of the initialized class.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.connector_utils.install_libraries">
<span class="sig-name descname"><span class="pre">install_libraries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">libs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.connector_utils.install_libraries" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-openetl_utils.database_utils">
<span id="openetl-utils-database-utils-module"></span><h2>openetl_utils.database_utils module<a class="headerlink" href="#module-openetl_utils.database_utils" title="Link to this heading"></a></h2>
<p>This module contains utility functions for working with SQLAlchemy engine connections.</p>
<p>Class:
- SQLAlchemyEngine: Represents a class to connect with any database using SQLAlchemy.</p>
<p>Methods:
- __init__: Initializes the class with database connection details.
- test: Tests the connection to the database.
- get_metadata: Retrieves schema metadata from the connection.
- execute_query: Executes a SQL query against the connection.
- get_metadata_df: Retrieves schema metadata in a dataframe format.</p>
<dl class="py class">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DatabaseUtils</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">engine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hostname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">username</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">password</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">database</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to connect with any database using SQLAlchemy.</p>
<p>Attributes:
- engine (string): Sqlalchemy dialect
- hostname (string): Your database hostname
- username (string): Your database username
- password (string): Your database password
- port (string): Your database port
- database (string): Your database
- connection_name (string, optional): Description of the connection. Defaults to None.
- connection_type (string, optional): Description of the connection type. Defaults to None.</p>
<p>Methods:
- __init__: Initializes the class with database connection details.
- test: Tests the connection to the database.
- get_metadata: Retrieves schema metadata from the connection.
- execute_query: Executes a SQL query against the connection.
- get_metadata_df: Retrieves schema metadata in a dataframe format.
- dataframe_details: Generates details about each column in a DataFrame.
- create_table: Creates a new table in the database.
- fill_na_based_on_dtype: Replaces NaN values in a DataFrame based on column data types.
- alter_table_column_add_or_drop: Alters a table by adding or dropping a column.
- drop_table: Drops the specified table from the database.
- truncate_table: Truncates a table by deleting all rows.
- cast_columns: Casts columns in a DataFrame to specific data types.
- map_to_spark_type: Maps Pandas DataFrame data types to Spark DataFrame data types.
- match_pandas_schema_to_spark: Matches data types of columns in a Spark DataFrame to a specified schema.
- write_data: Writes data to a table in the database.
- create_session: Creates a new session and initializes metadata and base.
- commit_changes: Commits the changes made within the session.
- close_session: Closes the session and sets the session close flag.
- __enter__: Enters the ‘with’ context and creates a new session.
- __exit__: Exits the ‘with’ context, commits changes, and closes the session.
- __dispose__: Disposes the session and engine.
- create_schema_if_not_exists: Creates a schema in the database if it does not already exist.
- alter_table_column_add_primary_key: Alters a table by adding a primary key to a specified column.
- create_document_table: Creates a document table in the database.
- create_batch_table: Creates a batch table in the database.
- fetch_rows: Executes a select query on the specified table with provided conditions.
- fetch_document: Fetches a single document based on the specified table, schema, and conditions.
- write_document: Writes a document to the specified table in the database.
- get_created_connections: Returns a list of created connections for the specified connector type.
- insert_openetl_batch: Inserts a new OpenETLBatch instance into the database.
- update_openetl_batch: Updates an OpenETLBatch instance in the database.
- get_dashboard_data: Retrieves dashboard data including total counts and integration details.</p>
<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.alter_table_column_add_or_drop">
<span class="sig-name descname"><span class="pre">alter_table_column_add_or_drop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column_details</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">ColumnActions.ADD</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.alter_table_column_add_or_drop" title="Link to this definition"></a></dt>
<dd><p>Alters a SQLAlchemy table by either adding or dropping a column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>action</strong> (<span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="#openetl_utils.enums.ColumnActions" title="openetl_utils.enums.ColumnActions"><code class="xref py py-class docutils literal notranslate"><span class="pre">ColumnActions</span></code></a></span>)</p></li>
<li><p><strong>table_name</strong> (<em>str</em>) – The name of the table to be altered.</p></li>
<li><p><strong>column_name</strong> (<em>str</em>) – The name of the column to be added or dropped. Required if drop_column is False.</p></li>
<li><p><strong>column_details</strong> (<em>str</em>) – The details of the column to be added. Required if drop_column is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing a boolean indicating success or failure and a message.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.alter_table_column_add_primary_key">
<span class="sig-name descname"><span class="pre">alter_table_column_add_primary_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'id'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schema_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'open_etl'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.alter_table_column_add_primary_key" title="Link to this definition"></a></dt>
<dd><p>Alter a table by adding a primary key to a specified column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table_name</strong> (<em>str</em>) – The name of the table to alter.</p></li>
<li><p><strong>column_name</strong> (<em>str</em>) – The name of the column to set as the primary key. Defaults to ‘id’.</p></li>
<li><p><strong>database.</strong> (<em>Currently not working changes do not reflect in the</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the primary key addition is successful, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.cast_columns">
<span class="sig-name descname"><span class="pre">cast_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.cast_columns" title="Link to this definition"></a></dt>
<dd><p>Function to cast columns in a DataFrame to specific data types based on the majority of data types in the columns.</p>
<p>Parameters:
- self: The object instance
- df: The DataFrame containing the columns to be cast</p>
<p>Returns:
- df: The DataFrame with columns cast to specific data types</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.close_session">
<span class="sig-name descname"><span class="pre">close_session</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.close_session" title="Link to this definition"></a></dt>
<dd><p>Close the session and set the session close flag.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.commit_changes">
<span class="sig-name descname"><span class="pre">commit_changes</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.commit_changes" title="Link to this definition"></a></dt>
<dd><p>Commit the changes made within the session.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.create_integration">
<span class="sig-name descname"><span class="pre">create_integration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integration_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integration_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_schema</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_schema</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spark_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hadoop_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cron_expression</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_connection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.create_integration" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.create_integration_history">
<span class="sig-name descname"><span class="pre">create_integration_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.create_integration_history" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.create_schema_if_not_exists">
<span class="sig-name descname"><span class="pre">create_schema_if_not_exists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schema_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'open_etl'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.create_schema_if_not_exists" title="Link to this definition"></a></dt>
<dd><p>Creates a schema in the database if it does not already exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>schema_name</strong> (<em>str</em>) – The name of the schema to create. Defaults to ‘open_etl’.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.create_session">
<span class="sig-name descname"><span class="pre">create_session</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.create_session" title="Link to this definition"></a></dt>
<dd><p>Create a new session and initialize metadata and base.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.create_table">
<span class="sig-name descname"><span class="pre">create_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_schema</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'public'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.create_table" title="Link to this definition"></a></dt>
<dd><p>Create a new table in the database. If already exists, skip creation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table_name</strong> (<em>str</em>) – The name of the table.</p></li>
<li><p><strong>schema_details</strong> (<em>dict</em>) – column_name with python datatypes. Valid values are <cite>str</cite>, <cite>float</cite>, <cite>bool</cite>, <cite>int</cite>, <cite>list</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple indicating the success status and a message.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.create_table_from_base">
<span class="sig-name descname"><span class="pre">create_table_from_base</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_schema</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'public'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.create_table_from_base" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.dataframe_details">
<span class="sig-name descname"><span class="pre">dataframe_details</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.dataframe_details" title="Link to this definition"></a></dt>
<dd><p>Generate a dictionary containing details about each column in the DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>DataFrame</em>) – The input DataFrame for which details are to be generated.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary where keys are column names and values are their data types.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.delete_document">
<span class="sig-name descname"><span class="pre">delete_document</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">document_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.delete_document" title="Link to this definition"></a></dt>
<dd><p>Deletes a document from the specified table in the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>document_id</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>)</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the document is successfully deleted, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Exception</strong> – If an error occurs while deleting the document. The error message is logged.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.delete_integration">
<span class="sig-name descname"><span class="pre">delete_integration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.delete_integration" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.delete_oauth_token">
<span class="sig-name descname"><span class="pre">delete_oauth_token</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connection_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.delete_oauth_token" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.drop_table">
<span class="sig-name descname"><span class="pre">drop_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.drop_table" title="Link to this definition"></a></dt>
<dd><p>Drop the specified table from the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>table_name</strong> (<em>str</em>) – The name of the table to drop.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple indicating the success status and a message.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.execute_query">
<span class="sig-name descname"><span class="pre">execute_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.execute_query" title="Link to this definition"></a></dt>
<dd><p>Execute query against the connection</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>query</strong> (<em>string</em>) – Valid SQL query</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Pandas dataframe of your query results</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.fetch_document">
<span class="sig-name descname"><span class="pre">fetch_document</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'openetl_documents'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schema_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'open_etl'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conditions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.fetch_document" title="Link to this definition"></a></dt>
<dd><p>Fetches a single document based on the specified table, schema, and conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table_name</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the table to fetch the document from. Defaults to ‘openetl_documents’.</p></li>
<li><p><strong>schema_name</strong> (<em>str</em><em>, </em><em>optional</em>) – The schema of the table. Defaults to ‘open_etl’.</p></li>
<li><p><strong>conditions</strong> (<em>dict</em><em>, </em><em>optional</em>) – The conditions to filter the document retrieval. Defaults to {}.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary representing the fetched document with column names as keys.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.fetch_rows">
<span class="sig-name descname"><span class="pre">fetch_rows</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'openetl_documents'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schema_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'open_etl'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conditions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.fetch_rows" title="Link to this definition"></a></dt>
<dd><p>Executes a select query on the specified table with the provided conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table_name</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the table to fetch rows from. Defaults to ‘openetl_documents’.</p></li>
<li><p><strong>schema_name</strong> (<em>str</em><em>, </em><em>optional</em>) – The schema of the table. Defaults to ‘open_etl’.</p></li>
<li><p><strong>conditions</strong> (<em>dict</em><em>, </em><em>optional</em>) – The conditions to filter the rows. Defaults to {}.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The result of the select query.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ResultProxy</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.fill_na_based_on_dtype">
<span class="sig-name descname"><span class="pre">fill_na_based_on_dtype</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.fill_na_based_on_dtype" title="Link to this definition"></a></dt>
<dd><p>Replace NaN values in a Pandas DataFrame based on the data type of each column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> – Pandas DataFrame.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame with NaN values replaced based on column data types.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.get_all_integration">
<span class="sig-name descname"><span class="pre">get_all_integration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">page</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">per_page</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integration_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.get_all_integration" title="Link to this definition"></a></dt>
<dd><p>Get all integrations paginated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>page</strong> (<em>int</em><em>, </em><em>optional</em>) – The page number. Defaults to 1.</p></li>
<li><p><strong>per_page</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of items per page. Defaults to 30.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the paginated results.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.get_created_connections">
<span class="sig-name descname"><span class="pre">get_created_connections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connector_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.get_created_connections" title="Link to this definition"></a></dt>
<dd><p>Returns a list of created connections for the specified connector type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>connector_type</strong> (<a class="reference internal" href="enums.html#enums.ConnectionType" title="enums.ConnectionType"><em>ConnectionType</em></a>) – The value of type of connector, defaults to ConnectionType.DATABASE.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dataframe of created connections.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.get_dashboard_data">
<span class="sig-name descname"><span class="pre">get_dashboard_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">page</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">per_page</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.get_dashboard_data" title="Link to this definition"></a></dt>
<dd><p>Retrieves dashboard data including total counts and paginated integration details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>page</strong> (<em>int</em><em>, </em><em>optional</em>) – The page number for integrations. Defaults to 1.</p></li>
<li><p><strong>per_page</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of items per page for integrations. Defaults to 30.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing total counts and paginated integration details.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.get_integration_history">
<span class="sig-name descname"><span class="pre">get_integration_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">integration_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">page</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">per_page</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.get_integration_history" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.get_integrations_to_schedule">
<span class="sig-name descname"><span class="pre">get_integrations_to_schedule</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.get_integrations_to_schedule" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">OpenETLIntegrations</span></code>]]</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.get_metadata">
<span class="sig-name descname"><span class="pre">get_metadata</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.get_metadata" title="Link to this definition"></a></dt>
<dd><p>Get schema metadata from the connection</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>{“tables”: tables,”schema”:[]}</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.get_metadata_df">
<span class="sig-name descname"><span class="pre">get_metadata_df</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.get_metadata_df" title="Link to this definition"></a></dt>
<dd><p>Get your schema metadata in a dataframe</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Pandas dataframe of your schema</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.get_oauth_token">
<span class="sig-name descname"><span class="pre">get_oauth_token</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connection_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.get_oauth_token" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.insert_openetl_batch">
<span class="sig-name descname"><span class="pre">insert_openetl_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integration_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_status</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integration_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rows_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end_date</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.insert_openetl_batch" title="Link to this definition"></a></dt>
<dd><p>Inserts a new OpenETLBatch instance into the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>integration_id</strong> – The ID of the integration.</p></li>
<li><p><strong>start_date</strong> (<em>datetime</em>) – The start date of the batch.</p></li>
<li><p><strong>batch_type</strong> (<em>str</em>) – The type of the batch.</p></li>
<li><p><strong>batch_status</strong> (<em>str</em>) – The status of the batch.</p></li>
<li><p><strong>batch_id</strong> (<em>str</em>) – The unique identifier of the batch.</p></li>
<li><p><strong>integration_name</strong> (<em>str</em>) – The name of the integration.</p></li>
<li><p><strong>rows_count</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of rows in the batch. Defaults to 0.</p></li>
<li><p><strong>end_date</strong> (<em>datetime</em><em>, </em><em>optional</em>) – The end date of the batch. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The newly created OpenETLBatch instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OpenETLBatch</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.map_to_spark_type">
<span class="sig-name descname"><span class="pre">map_to_spark_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pandas_dtype</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.map_to_spark_type" title="Link to this definition"></a></dt>
<dd><p>Map Pandas DataFrame data types to equivalent Spark DataFrame data types.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pandas_dtype</strong> (<em>str</em>) – Pandas DataFrame data type.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Spark DataFrame data type.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.match_pandas_schema_to_spark">
<span class="sig-name descname"><span class="pre">match_pandas_schema_to_spark</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spark_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schema_details</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.match_pandas_schema_to_spark" title="Link to this definition"></a></dt>
<dd><p>Match the data types of columns in a Spark DataFrame to a specified schema.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>schema_details</strong></p></li>
<li><p><strong>spark_df</strong> (<em>DataFrame</em>) – Spark DataFrame.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Spark DataFrame with matched data types.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.save_oauth_token">
<span class="sig-name descname"><span class="pre">save_oauth_token</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">access_token</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refresh_token</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expires_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scope</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.save_oauth_token" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>access_token</strong></p></li>
<li><p><strong>refresh_token</strong></p></li>
<li><p><strong>expires_in</strong></p></li>
<li><p><strong>scope</strong></p></li>
<li><p><strong>connection_id</strong></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.test">
<span class="sig-name descname"><span class="pre">test</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.test" title="Link to this definition"></a></dt>
<dd><p>Tests the database connection by attempting to establish a connection using the configured SQLAlchemy engine.</p>
<p>This method calls self.engine.connect() to verify that a connection to the database can be opened. If the connection attempt fails, an exception raised by the SQLAlchemy engine will propagate. On success, it returns True.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if the connection was successfully established.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.truncate_table">
<span class="sig-name descname"><span class="pre">truncate_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.truncate_table" title="Link to this definition"></a></dt>
<dd><p>Truncates a table by deleting all rows.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>table_name</strong> (<em>str</em>) – The name of the table to truncate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple indicating the success status and a message.</dt><dd><p>The success status is True if truncation is successful, False otherwise.
The message provides information about the truncation result.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.update_integration">
<span class="sig-name descname"><span class="pre">update_integration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record_id</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.update_integration" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.update_integration_runtime">
<span class="sig-name descname"><span class="pre">update_integration_runtime</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">job_id</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.update_integration_runtime" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.update_openetl_batch">
<span class="sig-name descname"><span class="pre">update_openetl_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integration_id</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.update_openetl_batch" title="Link to this definition"></a></dt>
<dd><p>Updates an OpenETLBatch object in the database with the specified batch_id.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_id</strong> (<em>int</em>) – The ID of the batch to update.</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments specifying the fields to update and their new values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated OpenETLBatch object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OpenETLBatch</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Exception</strong> – If no OpenETLBatch object with the specified batch_id is found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.update_openetl_document">
<span class="sig-name descname"><span class="pre">update_openetl_document</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">document_id</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.update_openetl_document" title="Link to this definition"></a></dt>
<dd><p>Updates an OpenETLBatch object in the database with the specified batch_id.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>document_id</strong> (<em>int</em>) – The ID of the batch to update.</p></li>
<li><p><strong>**kwargs</strong> – Keyword arguments specifying the fields to update and their new values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated OpenETLBatch object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>OpenETLBatch</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Exception</strong> – If no OpenETLBatch object with the specified batch_id is found.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.write_data">
<span class="sig-name descname"><span class="pre">write_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'openetl_batches'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">if_exists</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'append'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'public'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.write_data" title="Link to this definition"></a></dt>
<dd><p>Writes data to a table in etl_batches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>DataFrame</em>) – The DataFrame to write to the table.</p></li>
<li><p><strong>table_name</strong> (<em>str</em>) – The name of the table to write to.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.database_utils.DatabaseUtils.write_document">
<span class="sig-name descname"><span class="pre">write_document</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">document</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'openetl_documents'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schema_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'open_etl'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.DatabaseUtils.write_document" title="Link to this definition"></a></dt>
<dd><p>Writes a document to the specified table in the database.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>document</strong> (<em>dict</em>) – The document to be written. It should contain a ‘document’ key with the document content.</p></li>
<li><p><strong>table_name</strong> (<em>str</em><em>, </em><em>optional</em>) – The name of the table to write the document to. Defaults to ‘openetl_documents’.</p></li>
<li><p><strong>schema_name</strong> (<em>str</em><em>, </em><em>optional</em>) – The schema of the table. Defaults to ‘open_etl’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the document is successfully written, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>Exception</strong> – If an error occurs while writing the document. The error message is logged.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.database_utils.generate_cron_expression">
<span class="sig-name descname"><span class="pre">generate_cron_expression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">schedule_time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schedule_dates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.generate_cron_expression" title="Link to this definition"></a></dt>
<dd><p>Generates a cron expression based on provided scheduling details.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>schedule_time</strong> – Time string in ‘HH:MM:SS’ format.</p></li>
<li><p><strong>schedule_dates</strong> – List of date strings in ‘YYYY-MM-DD’ format or None.</p></li>
<li><p><strong>frequency</strong> – A string defining the frequency (‘daily’, ‘weekly’, ‘hourly’) or None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of cron expression strings.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.database_utils.get_open_etl_document_connection_details">
<span class="sig-name descname"><span class="pre">get_open_etl_document_connection_details</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.get_open_etl_document_connection_details" title="Link to this definition"></a></dt>
<dd><p>Get connection details for OpenETL Document</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.database_utils.parse_cron_expression">
<span class="sig-name descname"><span class="pre">parse_cron_expression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cron_expr</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.database_utils.parse_cron_expression" title="Link to this definition"></a></dt>
<dd><p>Parses a cron expression into its components, determines the next execution time,
and provides a human-readable explanation.</p>
<p>Args:
- cron_expr (str): A standard 5-part cron expression.</p>
<p>Returns:
- dict: Parsed cron details and next execution time.</p>
</dd></dl>

</section>
<section id="module-openetl_utils.enums">
<span id="openetl-utils-enums-module"></span><h2>openetl_utils.enums module<a class="headerlink" href="#module-openetl_utils.enums" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="openetl_utils.enums.APIMethod">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">APIMethod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names=&lt;not</span> <span class="pre">given&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qualname=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.enums.APIMethod" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.APIMethod.DELETE">
<span class="sig-name descname"><span class="pre">DELETE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'delete'</span></em><a class="headerlink" href="#openetl_utils.enums.APIMethod.DELETE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.APIMethod.GET">
<span class="sig-name descname"><span class="pre">GET</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'get'</span></em><a class="headerlink" href="#openetl_utils.enums.APIMethod.GET" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.APIMethod.PATCH">
<span class="sig-name descname"><span class="pre">PATCH</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'patch'</span></em><a class="headerlink" href="#openetl_utils.enums.APIMethod.PATCH" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.APIMethod.POST">
<span class="sig-name descname"><span class="pre">POST</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'post'</span></em><a class="headerlink" href="#openetl_utils.enums.APIMethod.POST" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.APIMethod.PUT">
<span class="sig-name descname"><span class="pre">PUT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'put'</span></em><a class="headerlink" href="#openetl_utils.enums.APIMethod.PUT" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="openetl_utils.enums.AuthType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">AuthType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names=&lt;not</span> <span class="pre">given&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qualname=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.enums.AuthType" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.AuthType.BASIC">
<span class="sig-name descname"><span class="pre">BASIC</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'basic'</span></em><a class="headerlink" href="#openetl_utils.enums.AuthType.BASIC" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.AuthType.BEARER">
<span class="sig-name descname"><span class="pre">BEARER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'bearer'</span></em><a class="headerlink" href="#openetl_utils.enums.AuthType.BEARER" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.AuthType.OAUTH2">
<span class="sig-name descname"><span class="pre">OAUTH2</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'oauth2'</span></em><a class="headerlink" href="#openetl_utils.enums.AuthType.OAUTH2" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.AuthType.SERVICE_ACCOUNT">
<span class="sig-name descname"><span class="pre">SERVICE_ACCOUNT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'service_account'</span></em><a class="headerlink" href="#openetl_utils.enums.AuthType.SERVICE_ACCOUNT" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="openetl_utils.enums.ColumnActions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ColumnActions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names=&lt;not</span> <span class="pre">given&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qualname=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.enums.ColumnActions" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.ColumnActions.ADD">
<span class="sig-name descname"><span class="pre">ADD</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'add'</span></em><a class="headerlink" href="#openetl_utils.enums.ColumnActions.ADD" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.ColumnActions.DROP">
<span class="sig-name descname"><span class="pre">DROP</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'drop'</span></em><a class="headerlink" href="#openetl_utils.enums.ColumnActions.DROP" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.ColumnActions.MODIFY">
<span class="sig-name descname"><span class="pre">MODIFY</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'modify'</span></em><a class="headerlink" href="#openetl_utils.enums.ColumnActions.MODIFY" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="openetl_utils.enums.ConnectionType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ConnectionType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names=&lt;not</span> <span class="pre">given&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qualname=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.enums.ConnectionType" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.ConnectionType.API">
<span class="sig-name descname"><span class="pre">API</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'api'</span></em><a class="headerlink" href="#openetl_utils.enums.ConnectionType.API" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.ConnectionType.DATABASE">
<span class="sig-name descname"><span class="pre">DATABASE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'database'</span></em><a class="headerlink" href="#openetl_utils.enums.ConnectionType.DATABASE" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="openetl_utils.enums.IntegrationType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">IntegrationType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names=&lt;not</span> <span class="pre">given&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qualname=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.enums.IntegrationType" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.IntegrationType.FULL_LOAD">
<span class="sig-name descname"><span class="pre">FULL_LOAD</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'full_load'</span></em><a class="headerlink" href="#openetl_utils.enums.IntegrationType.FULL_LOAD" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="openetl_utils.enums.LogsType">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">LogsType</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names=&lt;not</span> <span class="pre">given&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qualname=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.enums.LogsType" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.LogsType.API">
<span class="sig-name descname"><span class="pre">API</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'api'</span></em><a class="headerlink" href="#openetl_utils.enums.LogsType.API" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.LogsType.CELERY">
<span class="sig-name descname"><span class="pre">CELERY</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'celery'</span></em><a class="headerlink" href="#openetl_utils.enums.LogsType.CELERY" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.LogsType.INTEGRATION">
<span class="sig-name descname"><span class="pre">INTEGRATION</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'integration'</span></em><a class="headerlink" href="#openetl_utils.enums.LogsType.INTEGRATION" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.LogsType.SCHEDULER">
<span class="sig-name descname"><span class="pre">SCHEDULER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'scheduler'</span></em><a class="headerlink" href="#openetl_utils.enums.LogsType.SCHEDULER" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="openetl_utils.enums.RunStatus">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">RunStatus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names=&lt;not</span> <span class="pre">given&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qualname=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.enums.RunStatus" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.RunStatus.FAILED">
<span class="sig-name descname"><span class="pre">FAILED</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'failed'</span></em><a class="headerlink" href="#openetl_utils.enums.RunStatus.FAILED" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.RunStatus.RUNNING">
<span class="sig-name descname"><span class="pre">RUNNING</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'running'</span></em><a class="headerlink" href="#openetl_utils.enums.RunStatus.RUNNING" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.RunStatus.SUCCESS">
<span class="sig-name descname"><span class="pre">SUCCESS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'success'</span></em><a class="headerlink" href="#openetl_utils.enums.RunStatus.SUCCESS" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="openetl_utils.enums.TableAction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">TableAction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names=&lt;not</span> <span class="pre">given&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qualname=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boundary=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.enums.TableAction" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.TableAction.ALTER">
<span class="sig-name descname"><span class="pre">ALTER</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'alter'</span></em><a class="headerlink" href="#openetl_utils.enums.TableAction.ALTER" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.TableAction.CREATE">
<span class="sig-name descname"><span class="pre">CREATE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'create'</span></em><a class="headerlink" href="#openetl_utils.enums.TableAction.CREATE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.TableAction.DELETE">
<span class="sig-name descname"><span class="pre">DELETE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'delete'</span></em><a class="headerlink" href="#openetl_utils.enums.TableAction.DELETE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.TableAction.DROP">
<span class="sig-name descname"><span class="pre">DROP</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'drop'</span></em><a class="headerlink" href="#openetl_utils.enums.TableAction.DROP" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.TableAction.SELECT">
<span class="sig-name descname"><span class="pre">SELECT</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'select'</span></em><a class="headerlink" href="#openetl_utils.enums.TableAction.SELECT" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.TableAction.TRUNCATE">
<span class="sig-name descname"><span class="pre">TRUNCATE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'truncate'</span></em><a class="headerlink" href="#openetl_utils.enums.TableAction.TRUNCATE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.enums.TableAction.UPDATE">
<span class="sig-name descname"><span class="pre">UPDATE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'update'</span></em><a class="headerlink" href="#openetl_utils.enums.TableAction.UPDATE" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="module-openetl_utils.local_connection_utils">
<span id="openetl-utils-local-connection-utils-module"></span><h2>openetl_utils.local_connection_utils module<a class="headerlink" href="#module-openetl_utils.local_connection_utils" title="Link to this heading"></a></h2>
<p>This module contains functions related to store managing and retrieving information from .local folder.</p>
<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.local_connection_utils.check_jar_exists">
<span class="sig-name descname"><span class="pre">check_jar_exists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jar</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.local_connection_utils.check_jar_exists" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.local_connection_utils.create_con_directory">
<span class="sig-name descname"><span class="pre">create_con_directory</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.local_connection_utils.create_con_directory" title="Link to this definition"></a></dt>
<dd><p>Create all directories in dirs array.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.local_connection_utils.get_all_connection_configs">
<span class="sig-name descname"><span class="pre">get_all_connection_configs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.local_connection_utils.get_all_connection_configs" title="Link to this definition"></a></dt>
<dd><p>Get all connection configs from .local</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>array of connection configs</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.local_connection_utils.get_log_file_path">
<span class="sig-name descname"><span class="pre">get_log_file_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integration_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'INTEGRATION'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.local_connection_utils.get_log_file_path" title="Link to this definition"></a></dt>
<dd><p>Get log files from the specified directory, filtered and sorted by modification time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logs_dir</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – Directory where logs are stored.</p></li>
<li><p><strong>integration_id</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code> | <code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span>) – ID of the integration (if applicable).</p></li>
<li><p><strong>logs_type</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></span>) – Type of log file (e.g., “INTEGRATION”, “SCHEDULER”, “CELERY”, “API”).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</span></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of log file paths sorted by modification time (newest first).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.local_connection_utils.paginate_log_content">
<span class="sig-name descname"><span class="pre">paginate_log_content</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log_file_paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">page</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">per_page</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.local_connection_utils.paginate_log_content" title="Link to this definition"></a></dt>
<dd><p>Paginate the content of multiple log files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log_file_paths</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</span>) – A list of paths to log files.</p></li>
<li><p><strong>page</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) – The page number to retrieve.</p></li>
<li><p><strong>per_page</strong> (<span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></span>) – The number of lines per page.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>A list of paginated log entries from all log files (newest first).</p></li>
<li><p>The total number of pages across all log files.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A tuple containing</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.local_connection_utils.read_all_apis">
<span class="sig-name descname"><span class="pre">read_all_apis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.local_connection_utils.read_all_apis" title="Link to this definition"></a></dt>
<dd><p>Reads all the APIs from the API directory and returns a list of JSON file names.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of JSON file names without the extension.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.local_connection_utils.read_all_connection_configs">
<span class="sig-name descname"><span class="pre">read_all_connection_configs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.local_connection_utils.read_all_connection_configs" title="Link to this definition"></a></dt>
<dd><p>Read all connection configs database and JDBC</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>{“database”: database_data,”api”: jdbc_data}</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.local_connection_utils.read_all_pipeline_configs">
<span class="sig-name descname"><span class="pre">read_all_pipeline_configs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.local_connection_utils.read_all_pipeline_configs" title="Link to this definition"></a></dt>
<dd><p>Read all pipeline configurations from .local/pipelines</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of all pipelines</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.local_connection_utils.read_api_config">
<span class="sig-name descname"><span class="pre">read_api_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">apiname</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.local_connection_utils.read_api_config" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.local_connection_utils.read_connection_config">
<span class="sig-name descname"><span class="pre">read_connection_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.local_connection_utils.read_connection_config" title="Link to this definition"></a></dt>
<dd><p>Read a single config file from connections_directory in .local</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>string</em>) – Name of the config file</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>{‘filename’:’myconfiguration’, ‘data’:’json_data’}</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.local_connection_utils.read_connection_configs">
<span class="sig-name descname"><span class="pre">read_connection_configs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">configs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.local_connection_utils.read_connection_configs" title="Link to this definition"></a></dt>
<dd><p>Read all configuration files in config from .local folder</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>configs</strong> (<em>list</em>) – Names of configuration files</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>{‘filename’:’myconfiguration’}</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.local_connection_utils.read_pipeline_detals">
<span class="sig-name descname"><span class="pre">read_pipeline_detals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pipeline</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.local_connection_utils.read_pipeline_detals" title="Link to this definition"></a></dt>
<dd><p>Read single pipeline configuration</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>pipeline</strong> (<em>string</em>) – Name of the pipeline</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>details of the pipeline</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.local_connection_utils.read_single_connection_config">
<span class="sig-name descname"><span class="pre">read_single_connection_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.local_connection_utils.read_single_connection_config" title="Link to this definition"></a></dt>
<dd><p>Read single connection configuration from connection directory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>string</em>) – Name of the pipeline</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>config of the pipeline</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.local_connection_utils.store_connection_config">
<span class="sig-name descname"><span class="pre">store_connection_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">json_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_api</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.local_connection_utils.store_connection_config" title="Link to this definition"></a></dt>
<dd><p>Store connection settings in a file in .local</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – Connection name picked as filename</p></li>
<li><p><strong>json_data</strong> (<em>dict</em>) – Connection details as key value pair.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if saved else False</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Boolean</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-openetl_utils.main_api_class">
<span id="openetl-utils-main-api-class-module"></span><h2>openetl_utils.main_api_class module<a class="headerlink" href="#module-openetl_utils.main_api_class" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="openetl_utils.main_api_class.API">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">API</span></span><a class="headerlink" href="#openetl_utils.main_api_class.API" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.main_api_class.API.api">
<span class="sig-name descname"><span class="pre">api</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">''</span></em><a class="headerlink" href="#openetl_utils.main_api_class.API.api" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.main_api_class.API.authentication_details">
<span class="sig-name descname"><span class="pre">authentication_details</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#openetl_utils.main_api_class.API.authentication_details" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.main_api_class.API.base_url">
<span class="sig-name descname"><span class="pre">base_url</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">''</span></em><a class="headerlink" href="#openetl_utils.main_api_class.API.base_url" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.main_api_class.API.connect_to_api">
<span class="sig-name descname"><span class="pre">connect_to_api</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">auth_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">AuthType.BASIC</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">auth_params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.main_api_class.API.connect_to_api" title="Link to this definition"></a></dt>
<dd><p>Connects to a REST API using the specified authentication mechanism.</p>
<p>This method creates and configures a requests.Session object based on the provided
authentication type and credentials. Supported authentication methods are Basic and Bearer.
If OAuth2 authentication is requested, a NotImplementedError is raised.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>auth_type</strong> (<em>str</em>) – The authentication mechanism to use. Expected values include:
- AuthType.BASIC.value for Basic authentication
- AuthType.BEARER.value for Bearer token authentication
- AuthType.OAUTH2.value for OAuth2 authentication (not implemented)</p></li>
<li><p><strong>**auth_params</strong> – Additional keyword arguments needed for authentication. For example:
- For Basic authentication: ‘username’ (str) and ‘password’ (str)
- For Bearer authentication: ‘token’ (str)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A session object configured with the authentication credentials.</dt><dd><p>If an unrecognized auth_type is provided, the session is returned without extra authentication.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>requests.Session</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – If OAuth2 authentication (AuthType.OAUTH2.value) is specified.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.main_api_class.API.connection_name">
<span class="sig-name descname"><span class="pre">connection_name</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">''</span></em><a class="headerlink" href="#openetl_utils.main_api_class.API.connection_name" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.main_api_class.API.connection_type">
<span class="sig-name descname"><span class="pre">connection_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'api'</span></em><a class="headerlink" href="#openetl_utils.main_api_class.API.connection_type" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.main_api_class.API.construct_endpoint">
<span class="sig-name descname"><span class="pre">construct_endpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">endpoint</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.main_api_class.API.construct_endpoint" title="Link to this definition"></a></dt>
<dd><p>Constructs the endpoint URL for the given endpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>endpoint</strong> (<em>str</em>) – The endpoint to construct the URL for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The constructed endpoint URL.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.main_api_class.API.create_df">
<span class="sig-name descname"><span class="pre">create_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resp</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.main_api_class.API.create_df" title="Link to this definition"></a></dt>
<dd><p>Creates a pandas DataFrame from a given dictionary or list of dictionaries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>resp</strong> (<em>dict</em><em> or </em><em>list</em>) – A dictionary or list of dictionaries containing the data to be converted into a DataFrame.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A pandas DataFrame created from the input dictionary or list of dictionaries.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p>This function takes in a dictionary or list of dictionaries and converts it into a pandas DataFrame.
It iterates over the keys of the dictionary and checks if the corresponding value is a dictionary or a list.
If it is a dictionary, it uses <cite>pd.json_normalize</cite> to flatten the nested dictionary into a DataFrame.
If it is a list, it uses <cite>pd.json_normalize</cite> to flatten each element of the list into a DataFrame.
The resulting DataFrames are then concatenated using <cite>pd.concat</cite>.
Finally, the function converts all object columns to strings using <cite>df.astype(str)</cite> and returns the resulting DataFrame.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.main_api_class.API.database">
<span class="sig-name descname"><span class="pre">database</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'public'</span></em><a class="headerlink" href="#openetl_utils.main_api_class.API.database" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.main_api_class.API.fetch_data">
<span class="sig-name descname"><span class="pre">fetch_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">api_session</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">main_response_key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.main_api_class.API.fetch_data" title="Link to this definition"></a></dt>
<dd><p>Fetches data from the API using the provided session object.</p>
<p>Args:
- api_session (requests.Session): The session object with authentication configured.
- table (str): The table endpoint to fetch data from.
- main_response_key (str, optional): The key to use for nested structure. Defaults to None.</p>
<p>Returns:
- dict: The JSON response containing the fetched data.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.main_api_class.API.get_metadata">
<span class="sig-name descname"><span class="pre">get_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.main_api_class.API.get_metadata" title="Link to this definition"></a></dt>
<dd><p>Returns the metadata for the API.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary containing the metadata for the API.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.main_api_class.API.get_table_schema">
<span class="sig-name descname"><span class="pre">get_table_schema</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">api_session</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.main_api_class.API.get_table_schema" title="Link to this definition"></a></dt>
<dd><p>Retrieve the schema details of a table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>table_name</strong> (<em>str</em>) – The name of the table to get the schema for.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the schema details of the table.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.main_api_class.API.install_missing_libraries">
<span class="sig-name descname"><span class="pre">install_missing_libraries</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.main_api_class.API.install_missing_libraries" title="Link to this definition"></a></dt>
<dd><p>Checks if there are any missing libraries required for the function to run. If there are missing libraries, it calls the install_libraries function to install them.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the libraries are installed successfully, False otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.main_api_class.API.limit">
<span class="sig-name descname"><span class="pre">limit</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'limit':</span> <span class="pre">100}</span></em><a class="headerlink" href="#openetl_utils.main_api_class.API.limit" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.main_api_class.API.logo">
<span class="sig-name descname"><span class="pre">logo</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">''</span></em><a class="headerlink" href="#openetl_utils.main_api_class.API.logo" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.main_api_class.API.pagination">
<span class="sig-name descname"><span class="pre">pagination</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#openetl_utils.main_api_class.API.pagination" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.main_api_class.API.return_final_df">
<span class="sig-name descname"><span class="pre">return_final_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">responses</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.main_api_class.API.return_final_df" title="Link to this definition"></a></dt>
<dd><p>Generates a pandas DataFrame by concatenating the normalized JSON responses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>responses</strong> (<em>list</em>) – A list of JSON responses to be normalized and concatenated.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The concatenated DataFrame containing the normalized JSON responses.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.main_api_class.API.schema">
<span class="sig-name descname"><span class="pre">schema</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'public'</span></em><a class="headerlink" href="#openetl_utils.main_api_class.API.schema" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.main_api_class.API.supported_auths">
<span class="sig-name descname"><span class="pre">supported_auths</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[AuthType.BEARER,</span> <span class="pre">AuthType.OAUTH2,</span> <span class="pre">AuthType.BASIC]</span></em><a class="headerlink" href="#openetl_utils.main_api_class.API.supported_auths" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.main_api_class.API.tables">
<span class="sig-name descname"><span class="pre">tables</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{}</span></em><a class="headerlink" href="#openetl_utils.main_api_class.API.tables" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.main_api_class.API.test_connection">
<span class="sig-name descname"><span class="pre">test_connection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">api_session</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.main_api_class.API.test_connection" title="Link to this definition"></a></dt>
<dd><p>Tests the connection to the API by attempting to retrieve the schema for each table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>api_session</strong> (<em>requests.Session</em>) – The session object with authentication configured.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the connection is successful and the schema can be retrieved for at least one table, False otherwise.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="openetl_utils.main_api_class.OAuth2Client">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">OAuth2Client</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">client_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">client_secret</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auth_url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">token_url</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redirect_uri</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scope</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.main_api_class.OAuth2Client" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.main_api_class.OAuth2Client.get_access_token">
<span class="sig-name descname"><span class="pre">get_access_token</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">authorization_code</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.main_api_class.OAuth2Client.get_access_token" title="Link to this definition"></a></dt>
<dd><p>Exchange the authorization code for an access token.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.main_api_class.OAuth2Client.get_authorization_url">
<span class="sig-name descname"><span class="pre">get_authorization_url</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.main_api_class.OAuth2Client.get_authorization_url" title="Link to this definition"></a></dt>
<dd><p>Generate the authorization URL to redirect the user to the provider’s OAuth2 login.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-openetl_utils.main_db_class">
<span id="openetl-utils-main-db-class-module"></span><h2>openetl_utils.main_db_class module<a class="headerlink" href="#module-openetl_utils.main_db_class" title="Link to this heading"></a></h2>
<p>This module contains utility functions for working with SQLAlchemy engine connections.</p>
<p>Class:
- SQLAlchemyEngine: Represents a class to connect with any database using SQLAlchemy.</p>
<p>Methods:
- __init__: Initializes the class with database connection details.
- test: Tests the connection to the database.
- get_metadata: Retrieves schema metadata from the connection.
- execute_query: Executes a SQL query against the connection.
- get_metadata_df: Retrieves schema metadata in a dataframe format.</p>
<dl class="py class">
<dt class="sig sig-object py" id="openetl_utils.main_db_class.DB">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DB</span></span><a class="headerlink" href="#openetl_utils.main_db_class.DB" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#openetl_utils.database_utils.DatabaseUtils" title="openetl_utils.database_utils.DatabaseUtils"><code class="xref py py-class docutils literal notranslate"><span class="pre">DatabaseUtils</span></code></a></p>
<p>A class to connect with any database using SQLAlchemy.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.main_db_class.DB.authentication_details">
<span class="sig-name descname"><span class="pre">authentication_details</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{AuthType.BASIC:</span> <span class="pre">{'database':</span> <span class="pre">'',</span> <span class="pre">'hostname':</span> <span class="pre">'',</span> <span class="pre">'password':</span> <span class="pre">'',</span> <span class="pre">'port':</span> <span class="pre">0,</span> <span class="pre">'username':</span> <span class="pre">''}}</span></em><a class="headerlink" href="#openetl_utils.main_db_class.DB.authentication_details" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.main_db_class.DB.close_session">
<span class="sig-name descname"><span class="pre">close_session</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.main_db_class.DB.close_session" title="Link to this definition"></a></dt>
<dd><p>Close the session and set the session close flag.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></span></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.main_db_class.DB.connection_type">
<span class="sig-name descname"><span class="pre">connection_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'database'</span></em><a class="headerlink" href="#openetl_utils.main_db_class.DB.connection_type" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.main_db_class.DB.create_engine">
<span class="sig-name descname"><span class="pre">create_engine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">engine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hostname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">username</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">password</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">port</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">database</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.main_db_class.DB.create_engine" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.main_db_class.DB.execute_query">
<span class="sig-name descname"><span class="pre">execute_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.main_db_class.DB.execute_query" title="Link to this definition"></a></dt>
<dd><p>Execute query against the connection</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>query</strong> (<em>string</em>) – Valid SQL query</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Pandas dataframe of your query results</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dataframe</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.main_db_class.DB.get_metadata">
<span class="sig-name descname"><span class="pre">get_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.main_db_class.DB.get_metadata" title="Link to this definition"></a></dt>
<dd><p>Returns the metadata for the API.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary containing the metadata for the API.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.main_db_class.DB.install_missing_libraries">
<span class="sig-name descname"><span class="pre">install_missing_libraries</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.main_db_class.DB.install_missing_libraries" title="Link to this definition"></a></dt>
<dd><p>Checks if there are any missing libraries required for the function to run. If there are missing libraries, it calls the install_libraries function to install them.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True if the libraries are installed successfully, False otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.main_db_class.DB.read_table">
<span class="sig-name descname"><span class="pre">read_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schema_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'public'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">page_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.main_db_class.DB.read_table" title="Link to this definition"></a></dt>
<dd><p>Read data from a table in etl_batches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table_name</strong> (<em>str</em>) – The name of the table to read from.</p></li>
<li><p><strong>page_size</strong> (<em>int</em><em>, </em><em>optional</em>) – The number of rows to read per page. Defaults to 10000.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The DataFrame containing the data from the table.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="openetl_utils.main_db_class.DB.required_libs">
<span class="sig-name descname"><span class="pre">required_libs</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#openetl_utils.main_db_class.DB.required_libs" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.main_db_class.DB.test_connection">
<span class="sig-name descname"><span class="pre">test_connection</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.main_db_class.DB.test_connection" title="Link to this definition"></a></dt>
<dd><p>Test connection to database</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if connected else False</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Boolean</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.main_db_class.DB.write_data">
<span class="sig-name descname"><span class="pre">write_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">if_exists</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'append'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'public'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.main_db_class.DB.write_data" title="Link to this definition"></a></dt>
<dd><p>Writes data to a table in etl_batches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>DataFrame</em>) – The DataFrame to write to the table.</p></li>
<li><p><strong>table_name</strong> (<em>str</em>) – The name of the table to write to.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></span></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-openetl_utils.pipeline_utils">
<span id="openetl-utils-pipeline-utils-module"></span><h2>openetl_utils.pipeline_utils module<a class="headerlink" href="#module-openetl_utils.pipeline_utils" title="Link to this heading"></a></h2>
<p>This module contains utility functions related to Airflow tasks and workflows.</p>
<p>Functions:
- run_pipeline: Runs the specified pipeline based on the provided parameters.
- get_data: Retrieves data based on the specified parameters.
- preprocess_data: Preprocesses the data before further processing.
- post_process_data: Performs post-processing tasks on the data.
- validate_data: Validates the data to ensure quality and consistency.</p>
<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.pipeline_utils.create_airflow_dag">
<span class="sig-name descname"><span class="pre">create_airflow_dag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.pipeline_utils.create_airflow_dag" title="Link to this definition"></a></dt>
<dd><p>Store pipeline configuration in .local/pipelines directory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<em>string</em>) – Name of the pipeline</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Boolean, Config. True if stored</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.pipeline_utils.extract_xcom_value">
<span class="sig-name descname"><span class="pre">extract_xcom_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_id</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">context</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.pipeline_utils.extract_xcom_value" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.pipeline_utils.read_data">
<span class="sig-name descname"><span class="pre">read_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connector_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auth_values</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auth_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">connection_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schema</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'public'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.pipeline_utils.read_data" title="Link to this definition"></a></dt>
<dd><p>Reads data from a specified connection type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>connection_type</strong> (<em>str</em>) – The type of connection to use. Valid values are “database” or “api”.</p></li>
<li><p><strong>table</strong> (<em>str</em>) – The name of the table to read from.</p></li>
<li><p><strong>schema</strong> (<em>str</em>) – The schema of the table.</p></li>
<li><p><strong>connection_name</strong> (<em>str</em>) – The name of the connection.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If the connection type is “database”, returns a Spark DataFrame containing the data. If the connection type is “api” returns a pandas DataFrame containing the data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Union[DataFrame]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the connection type is not “database” or “api”.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.pipeline_utils.run_pipeline">
<span class="sig-name descname"><span class="pre">run_pipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spark_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hadoop_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_schema</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_schema</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_connection_details</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_connection_details</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.pipeline_utils.run_pipeline" title="Link to this definition"></a></dt>
<dd><p>A function that runs a pipeline with the specified configurations, particularly used in the airflow DAG to run a pipeline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logger</strong></p></li>
<li><p><strong>target_schema</strong></p></li>
<li><p><strong>job_type</strong></p></li>
<li><p><strong>job_id</strong></p></li>
<li><p><strong>job_name</strong></p></li>
<li><p><strong>target_table</strong></p></li>
<li><p><strong>source_connection_details</strong></p></li>
<li><p><strong>target_connection_details</strong></p></li>
<li><p><strong>batch_size</strong></p></li>
<li><p><strong>source_table</strong> (<em>str</em>) – The name of the source table.</p></li>
<li><p><strong>source_schema</strong> (<em>str</em>) – The schema of the source table.</p></li>
<li><p><strong>spark_config</strong> (<em>dict</em><em>, </em><em>optional</em>) – The Spark configuration. Defaults to None.</p></li>
<li><p><strong>hadoop_config</strong> (<em>dict</em><em>, </em><em>optional</em>) – The Hadoop configuration. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>Exception</strong> – If no data is found in the source table.</p></li>
<li><p><strong>NotImplementedError</strong> – If the target connection type is API.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.pipeline_utils.run_pipeline_target">
<span class="sig-name descname"><span class="pre">run_pipeline_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integration_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spark_class</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">con_string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">driver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spark_session</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_class</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.pipeline_utils.run_pipeline_target" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="openetl_utils.pipeline_utils.update_integration_in_db">
<span class="sig-name descname"><span class="pre">update_integration_in_db</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">celery_task_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error_message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_status</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row_count</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.pipeline_utils.update_integration_in_db" title="Link to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="openetl-utils-scheduler-utils-module">
<h2>openetl_utils.scheduler_utils module<a class="headerlink" href="#openetl-utils-scheduler-utils-module" title="Link to this heading"></a></h2>
</section>
<section id="module-openetl_utils.spark_utils">
<span id="openetl-utils-spark-utils-module"></span><h2>openetl_utils.spark_utils module<a class="headerlink" href="#module-openetl_utils.spark_utils" title="Link to this heading"></a></h2>
<p>This module contains utility functions and classes for working with Apache Spark.</p>
<p>Classes:
- SparkConnection: Represents a connection to a Spark cluster.</p>
<p>Functions:
- initializeSpark: Initializes a Spark connection and configures the Spark session based on the connection and configuration details.
- read_via_spark: Reads data using Spark based on the specified connection format and credentials.
- other_function_name(): Description of what this function does.
- another_function_name(): Description of what this function does.</p>
<dl class="py class">
<dt class="sig sig-object py" id="openetl_utils.spark_utils.SparkConnection">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">SparkConnection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">connection_string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spark_configuration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hadoop_configuration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.spark_utils.SparkConnection" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class representing a connection to a Spark cluster.</p>
<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">(str)</span></span></dt>
<dd><p>The connection string for the Spark cluster.</p>
<blockquote>
<div><p>spark_configuration (dict): Dictionary containing Spark configuration details.
hadoop_configuration (dict, optional): Dictionary containing Hadoop configuration details.
jar (None): Placeholder for the JAR file.</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.spark_utils.SparkConnection.initializeSpark">
<span class="sig-name descname"><span class="pre">initializeSpark</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.spark_utils.SparkConnection.initializeSpark" title="Link to this definition"></a></dt>
<dd><p>Initializes a Spark connection and configures the Spark session.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.spark_utils.SparkConnection.read_via_spark">
<span class="sig-name descname"><span class="pre">read_via_spark</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.spark_utils.SparkConnection.read_via_spark" title="Link to this definition"></a></dt>
<dd><p>Reads data using Spark based on the specified connection format and credentials.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.spark_utils.SparkConnection.write_via_spark">
<span class="sig-name descname"><span class="pre">write_via_spark</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataframe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conn_string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">driver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'append'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jdbc'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.spark_utils.SparkConnection.write_via_spark" title="Link to this definition"></a></dt>
<dd><p>Writes data using Spark.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="openetl_utils.spark_utils.SparkConnection.__dispose__">
<span class="sig-name descname"><span class="pre">__dispose__</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#openetl_utils.spark_utils.SparkConnection.__dispose__" title="Link to this definition"></a></dt>
<dd><p>Disposes the Spark session and engine.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">initializeSpark</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#id0" title="Link to this definition"></a></dt>
<dd><p>Initializes a Spark connection and configures the Spark session based on the connection and configuration details.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The initialized SparkSession object.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pyspark.sql.SparkSession</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – If an error occurs during Spark initialization.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">read_via_spark</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spark_connection_details</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jdbc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id1" title="Link to this definition"></a></dt>
<dd><p>Reads data from a Spark DataFrame using limit/offset pagination, yielding batches of data until all rows are read.
Stops if all rows in a batch are null.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spark_connection_details</strong> (<em>dict</em>) – The connection details.</p></li>
<li><p><strong>source_format</strong> (<em>str</em>) – The source format (e.g., “jdbc”).</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – The number of rows per batch.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>pyspark.sql.DataFrame</em> – A Spark DataFrame containing a batch of rows.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – If an error occurs during the data reading process.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">write_via_spark</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataframe</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conn_string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">driver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'append'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jdbc'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id2" title="Link to this definition"></a></dt>
<dd><p>The write_via_spark method is used to write data using Spark based on the specified connection format and credentials.
It takes the DataFrame stored in the sparkDataframe attribute of the SparkConnection object and writes it to the target data destination.</p>
<p>The method requires a valid connection format and corresponding credentials to establish the connection for writing data.
It uses the write method of the DataFrame API, specifying the connection format, options, and save mode.</p>
<p>If any error occurs during the data writing process, an exception is raised.</p>
<p>This method is typically used after establishing a Spark connection, configuring the connection format and credentials, and preparing the data in the sparkDataframe attribute.</p>
<p>Please note that in the provided code snippet, the variables connection_type, connection_dict, and mode are not defined.
Make sure to replace them with the appropriate values based on your implementation.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Exception</strong> – If an error occurs during the data writing process.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-openetl_utils">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-openetl_utils" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, DataOmni Solutions.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>